# DDS validation investigation (v3)

## 问题症状
- `val_mAP@0.5` 约 0.20、`val_meanIoU` ~0.005，预测红框数量远多于 GT，且几乎不重合。

## 根因分析
- 训练/验证输入将原图 **直接拉伸到 640×640**，但 GT 仍是按原始宽高归一化的 YOLO 坐标。
- 由于没有做等比例 letterbox，宽高比被拉伸，GT 框与模型预测（基于拉伸后图像）发生系统性偏移，导致 IoU 极低，mAP 接近 0。

## 采取的修复
- 为训练/验证/推理的数据加载加入 **letterbox 等比例缩放+填充** 到 640×640，并对 GT 框做同样的缩放与填充偏移，再重新归一化。
- 处理后的 GT 统一与模型解码坐标系一致（均为 letterbox 之后、0-1 归一化），避免了框错位。

## 后续建议
- 重新训练或至少重新验证，确认 IoU、mAP 是否恢复到合理水平；如仍偏低，再检查类别映射和锚框尺寸是否与数据集统计匹配。
